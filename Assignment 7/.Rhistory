load("PentathlonTargeting.Rdata")
load("PentathlonTargeting.Rdata")
pent <- pent %>% mutate(age=factor(age), female=factor(female), buyer=factor(buyer))
library(gmodels)
library(modelr)
library(janitor)
library(haven)
library(readxl)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
load("PentathlonTargeting.Rdata")
pent <- pent %>% mutate(age=factor(age), female=factor(female), buyer=factor(buyer))
View(pent)
load("PentathlonTargeting.Rdata")
pent <- pent %>% mutate(age=factor(age), female=factor(female), buyer=factor(buyer))
#Now we create the training and testing split
pent.training<- pent%>% filter(training==1)
pent.testing<- pent%>% filter(training==0)
# First  we create a logistic regression model for every type of offer ( endurance, backcountry, etc)
lr.backcountry <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="backcountry"))
load("PentathlonTargeting.Rdata")
pent <- pent %>% mutate(age=factor(age), female=factor(female), buyer=factor(buyer))
#Now we create the training and testing split
pent.train<- pent%>% filter(training==1)
pent.test<- pent%>% filter(training==0)
# First  we create a logistic regression model for every type of offer ( endurance, backcountry, etc)
lr.backcountry <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="backcountry"))
pent.test <- pent.test %>%
mutate(pr.backcountry = predict(lr.backcountry, newdata=bbb.nptb.test, type="response"))
# First  we create a logistic regression model for every type of offer ( endurance, backcountry, etc)
lr.backcountry <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="backcountry"))
pent.test <- pent.test %>%
mutate(pr.backcountry = predict(lr.backcountry, newdata=pent.test, type="response"))
knitr::opts_chunk$set(echo=TRUE,      # Print all the code in all the chunks
warning=FALSE,  # Don't print warning statements
message=FALSE,  # Don't print other R output messages
comment=NA)     # Helps produce prettier output
library(gmodels)
library(modelr)
library(janitor)
library(haven)
library(readxl)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
load("PentathlonTargeting.Rdata")
pent <- pent %>% mutate(age=factor(age), female=factor(female), buyer=factor(buyer))
#Now we create the training and testing split
pent.train<- pent%>% filter(training==1)
pent.test<- pent%>% filter(training==0)
# First  we create a logistic regression model for every type of offer ( endurance, backcountry, etc)
lr.backcountry <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="backcountry"))
pent.test <- pent.test %>%
mutate(pr.backcountry = predict(lr.backcountry, newdata=pent.test, type="response"))
# Endurance
lr.endurance <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="endurance"))
pent.test <- pent.test %>%
mutate(pr.endurance = predict(lr.endurance, newdata=pent.test, type="response"))
# Strength
lr.strength <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="strength"))
pent.test <- pent.test %>%
mutate(pr.endurance = predict(lr.strength, newdata=pent.test, type="response"))
#Water
lr.water <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="water"))
pent.test <- pent.test %>%
mutate(pr.water = predict(lr.water, newdata=pent.test, type="response"))
#Team
lr.team <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="team"))
pent.test <- pent.test %>%
mutate(pr.team = predict(lr.team, newdata=pent.test, type="response"))
#Winter
lr.winter <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="winter"))
pent.test <- pent.test %>%
mutate(pr.winter = predict(lr.winter, newdata=pent.test, type="response"))
#Winter
lr.racquet <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="racquet"))
pent.test <- pent.test %>%
mutate(pr.racquet = predict(lr.caquet, newdata=pent.test, type="response"))
#Winter
lr.racquet <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="racquet"))
pent.test <- pent.test %>%
mutate(pr.racquet = predict(lr.racquet, newdata=pent.test, type="response"))
pent.test<pent.test %>%
mutate(pr.max=pmax(pr.backcountry, pr.endurance, pr.water, pr.team, pr.winter, pr.racquet),
mail.offer=case_when(
pr.backcountry==pr.max,
pr.endurance==pr.max,
pr.water==pr.max,
pr.team==pr.max,
pr.winter==pr.max,
pr.racquet==pr.max
))
pent.test<pent.test %>%
mutate(pr.max=pmax(pr.backcountry, pr.endurance, pr.water, pr.team, pr.winter, pr.racquet),
mail.offer=case_when(
pr.backcountry==pr.max ~ "Backcountry",
pr.endurance==pr.max~ "Endurance",
pr.water==pr.max~ "Water",
pr.team==pr.max ~ "Team",
pr.winter==pr.max~ "Winter",
pr.racquet==pr.max ~ "Racquet"))
pent.test<- pent.test %>%
mutate(pr.max = pmax(pr.backcountry, pr.endurance, pr.water, pr.team, pr.winter, pr.racquet),
mail.offer=case_when(
pr.backcountry==pr.max ~ "Backcountry",
pr.endurance==pr.max~ "Endurance",
pr.water==pr.max~ "Water",
pr.team==pr.max ~ "Team",
pr.winter==pr.max~ "Winter",
pr.racquet==pr.max ~ "Racquet"))
pent.test%>% tabyl(mail.offer )
knitr::opts_chunk$set(echo=TRUE,      # Print all the code in all the chunks
warning=FALSE,  # Don't print warning statements
message=FALSE,  # Don't print other R output messages
comment=NA)     # Helps produce prettier output
library(gmodels)
library(modelr)
library(janitor)
library(haven)
library(readxl)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
load("PentathlonTargeting.Rdata")
pent <- pent %>% mutate(age=factor(age), female=factor(female), buyer=factor(buyer))
#Now we create the training and testing split
pent.train<- pent%>% filter(training==1)
pent.test<- pent%>% filter(training==0)
# First  we create a logistic regression model for every type of offer ( endurance, backcountry, etc)
lr.backcountry <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="backcountry"))
pent.test <- pent.test %>%
mutate(pr.backcountry = predict(lr.backcountry, newdata=pent.test, type="response"))
# Endurance
lr.endurance <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="endurance"))
pent.test <- pent.test %>%
mutate(pr.endurance = predict(lr.endurance, newdata=pent.test, type="response"))
# Strength
lr.strength <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="strength"))
pent.test <- pent.test %>%
mutate(pr.endurance = predict(lr.strength, newdata=pent.test, type="response"))
#Water
lr.water <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="water"))
pent.test <- pent.test %>%
mutate(pr.water = predict(lr.water, newdata=pent.test, type="response"))
#Team
lr.team <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="team"))
pent.test <- pent.test %>%
mutate(pr.team = predict(lr.team, newdata=pent.test, type="response"))
#Winter
lr.winter <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="winter"))
pent.test <- pent.test %>%
mutate(pr.winter = predict(lr.winter, newdata=pent.test, type="response"))
#Winter
lr.racquet <- glm(buyer ~ age + female + income + education + children+ freq_endurance+freq_strength+freq_water+freq_team+freq_backcountry+freq_winter+freq_racquet,
family=binomial, data=pent.train %>% filter(message=="racquet"))
pent.test <- pent.test %>%
mutate(pr.racquet = predict(lr.racquet, newdata=pent.test, type="response"))
pent.test<- pent.test %>%
mutate(pr.max = pmax(pr.backcountry, pr.endurance, pr.water, pr.team, pr.winter, pr.racquet),
mail.offer=case_when(
pr.backcountry==pr.max ~ "Backcountry",
pr.endurance==pr.max~ "Endurance",
pr.water==pr.max~ "Water",
pr.team==pr.max ~ "Team",
pr.winter==pr.max~ "Winter",
pr.racquet==pr.max ~ "Racquet"))
pent.test%>% tabyl(mail.offer )
