knitr::opts_chunk$set(echo=TRUE,      # Print all the code in all the chunks
warning=FALSE,  # Don't print warning statements
message=FALSE,  # Don't print other R output messages
comment=NA)     # Helps produce prettier output
library(gmodels)
library(modelr)
library(janitor)
library(haven)
library(readxl)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(mktg482)
# use load("filename.Rdata") for .Rdata files
load("smobile_churn.Rdata")
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("smobile_churn.Rdata")
smobile_training <- smobile %>% filter(training==1)
smobile_test<-smobile %>% filter(training==0)
smobile_training_lr<-glm(churn~revenue+mou+overage+roam+changem+changer+dropvce+blckvce+unansvce+custcare+threeway+months+uniqsubs+phones+eqpdays+age+children+creditaa+refurb+occprof+occcler+occcrft+occstud+occhmkr+occret+occself+travel+retcalls+refer+incmiss+income+mcycle,family=binomial, data=smobile_training)
summary(smobile_training_lr)
#Adding Odds Rations
cbind(COEF=coef(smobile_training_lr),confint(smobile_training_lr))
exp(cbind(COEF=coef(smobile_training_lr),confint(smobile_training_lr)))
pred_lr_training<-predict(smobile_training_lr, type="response")
pred_lr_test<-predict(smobile_training_lr,newdata=smobile_test ,type="response")
pred_lr_training <- predict(smobile_training_lr,type="response")
pred_lr_test <- predict(smobile_training_lr, newdata=smobile_test,type="response")
gainsplot(pred_lr_test,label.var =smobile_test$res)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
imp.glm(smobile_training_lr)
#devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
varimp.logistic(smobile_training_lr)
imp.glm(smobile_training_lr)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
install.packages(glmnet)
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(caret)
#devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
install.packages(glmnet)
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(caret)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
install.packages(glmnet)
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(caret)
install.packages('TMB', type = 'source')
install.packages("TMB", type = "source")
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
install.packages(glmnet)
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(caret)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
#devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
### Load packages:
#library(knitr)
library(janitor)
#library(readxl)
#library(psych)
#library(statar)
#library(tictoc)
#library(mktg482)
library(tidyverse)
#library(sjPlot)
#library(caret)
#library(glmnet)
#library(printr)
library(AlgDesign)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
### Load packages:
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(tictoc)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
### Load packages:
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(caret)
library(glmnet)
library(mktg482)
library(glmnet)
library(AlgDesign)
library(printr)
install.packages(glmnet)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
### Load packages:
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(mktg482)
library(printr)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(glmnet)
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(printr)
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
rm(list=ls())
set.seed(13579)
load("smobile_churn.Rdata")
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
smobile_training <- smobile %>% filter(training==1)
smobile_test<-smobile %>% filter(training==0)
smobile_training_lr<-glm(churn~revenue+mou+overage+roam+changem+changer+dropvce+blckvce+unansvce+custcare+threeway+months+uniqsubs+phones+eqpdays+age+children+creditaa+refurb+occprof+occcler+occcrft+occstud+occhmkr+occret+occself+travel+retcalls+refer+incmiss+income+mcycle,family=binomial, data=smobile_training)
summary(smobile_training_lr)
#Adding Odds Rations
cbind(COEF=coef(smobile_training_lr),confint(smobile_training_lr))
exp(cbind(COEF=coef(smobile_training_lr),confint(smobile_training_lr)))
pred_lr_training<-predict(smobile_training_lr, type="response")
pred_lr_test<-predict(smobile_training_lr,newdata=smobile_test ,type="response")
pred_lr_training <- predict(smobile_training_lr,type="response")
pred_lr_test <- predict(smobile_training_lr, newdata=smobile_test,type="response")
pred_lr_training <- predict(smobile_training_lr,type="response")
pred_lr_test <- predict(smobile_training_lr, newdata=smobile_test,type="response")
plot_model(smobile_training_lr)
plot_model(smobile_training_lr,type="pred")
varimp.logistic(smobile_training_lr)
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_lr_test, label.var =smobile_test$res )
gainsplot(pred_lr_test, pred_lr_training label.var =smobile_test$res )
gainsplot(pred_lr_test, label.var =smobile_test$res )
pred_lr_test = predict(m1, smobile_test)[,2]
str(pred_lr_test)  ```
str(pred_lr_test)
pred_lr_rollout <- predict(smobile_training_lr, newdata=rollout,type="response")
pred_lr_training <- predict(smobile_training_lr,data= smobile+training, type="response")
gainsplot(pred_lr_test, label.var =smobile_test$res )
rollout <- rollout %>%
mutate(predictions=pred_lr_rollout)
View(rollout)
View(rollout)
