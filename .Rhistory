knitr::opts_chunk$set(echo = TRUE)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=sum(target_log), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
