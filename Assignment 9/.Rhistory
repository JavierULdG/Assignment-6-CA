accounts_lr<-glm( sale~ APR + Date + Annual_Fee + VISA_MC + BK, family=binomial, data=data1)
accounts_lr<-glm(sale~ APR + Date + Annual_Fee + VISA_MC + BK, family=binomial, data=data1, maxit=100)
accounts_lr<-glm(sale~ APR + Date + Annual_Fee + VISA_MC + BK, family=binomial, data=data1, maxit=1000)
asdasd
install.packages("AlgDesign")
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(AlgDesign)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`), sale=factor(sale))
data1<-uncount(data1_count, `Accounts`)
str(data1)
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(sale~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(sale~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`), sale=factor(sale))
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(sale~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
View(data1)
View(data1)
View(data1_count)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
data2<- read_csv("Data2.csv")
data2<- read_csv("Data2.csv")
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(AlgDesign)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
data2<- read_csv("Data2.csv")
View(data2)
data2<- read_csv("Data2.csv")
data2<- read_csv("Data2.csv")
LTV.reg <-lm(LTV ~ APR + Fix_Var+Annual_Fee + VISA_MC + BK, data2)
View(data2)
data2<- read_csv("Data2.csv")
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Annual_Fee + VISA_MC + BK, data2)
data2<- read_csv("Data2.csv")
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
data2<- read_csv("Data2.csv")
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
LTV.reg
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(AlgDesign)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
View(data1_count)
View(data1_count)
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
data2<- read_csv("Data2.csv")
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
LTV.reg
View(data2)
View(data2)
View(LTV.reg)
View(LTV.reg)
View(LTV.reg)
View(LTV.reg)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
reg.data1 <-lm(Sales~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data1_count)
summary(reg.data1)
View(data1_count)
View(data1_count)
data1_count<- read_csv("Data1v2-testing.csv")
data1_testing<- read_csv("Data1v2-testing.csv")
data1_count<- read_csv("Data1v2.csv")
View(data1_testing)
View(data1_testing)
data1_testing<- read_csv("Data1v2-testing.csv")
data1_testing<- read_csv("Data1v2-testing.csv")
data1_testing<- read_csv("Data1v2-testing.csv")
reg.data1 <-lm(Sales~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data1_testing)
summary(reg.data1)
lr2.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_testing, family=binomial)
summary(lr2.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr2.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_testing, family=binomial)
summary(lr2.data1)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(AlgDesign)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
lr2.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_testing, family=binomial)
pred_lr_training<-predict(lr.data1, type="response")
database<- read_csv("TestDatabase.csv")
database<- read_csv("TestDatabase.csv")
database <- database %>%
mutate(prediction=(pred_lr_training<-predict(lr.data1, type="response"))
database <- database %>%
mutate(prediction=(pred_lr_training<-predict(lr.data1, type="response"))
data2<- read_csv("Data2.csv")
database<- read_csv("TestDatabase.csv")
database <- database %>%
mutate(prediction=(pred_lr_training<-predict(lr.data1, type="response")
mutate(prediction=predict(lr.data1, type="response")
mutate(prediction=predict(lr.data1, type="response")
mutate(prediction=predict(lr.data1, type="response"))
database <- pred_;r_training %>%
database <- pred_lr_training %>%
View(database)
View(database)
database<- read_csv("TestDatabase.csv")
View(database)
View(database)
mutate(Sales_Pred=predict(lr.data1, type="response"))
database <- pred_lr_training %>%
mutate(Sales_Pred=predict(lr.data1, newdata=database type="response"))
database<- read_csv("TestDatabase.csv")
View(full.design)
View(full.design)
database<- read_csv("TestDatabase.csv")
database <- pred_lr_training %>%
mutate(Sales_Pred=predict(lr.data1, newdata=database, type="response"))
database<- read_csv("TestDatabase.csv")
database <- pred_lr_training %>%
mutate(Sales_Pred=predict(lr.data1, newdata=database, type="raw"))
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
pred_lr_training<-predict(lr.data1, type="response")
pred_lr_test<-predict(intuit_lr,newdata=database ,type="response")
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
pred_lr_training<-predict(lr.data1, type="response")
pred_lr_test<-predict(lr.data1,newdata=database ,type="response")
View(data1_count)
View(data1_count)
pred_lr_training<-predict(lr.data1, type="response")
pred_lr_test<-predict(lr.data1,newdata=data2 ,type="response")
data2 <- data1_count %>% mutate(prediction=pred_lr_test)
pred_lr_training<-predict(lr.data1, type="response")
pred_lr_test<-predict(lr.data1,newdata=data2 ,type="response")
data2<- read_csv("Data2.csv")
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
LTV.reg
pred_lr_training<-predict(lr.data1, type="response")
pred_lr_test<-predict(lr.data1,newdata=data2 ,type="response")
data2<- read_csv("Data2.csv")
pred_lr_test<-predict(lr.data1,newdata=data2 ,type="response")
data2<- read_csv("Data2.csv")
data2<-data2%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee),  `BK`=factor(`BK`))
data2 <- data1_count %>% mutate(prediction=pred_lr_test)
pred_lr_test<-predict(lr.data1,newdata=data2 ,type="response")
get.estimable.coefficients(full.design, frac.design)
data1_count<- read_csv("Data1v2.csv")
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
get.estimable.coefficients(full.design, frac.design)
data2<- read_csv("Data2.csv")
data2<-data2%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee),  `BK`=factor(`BK`))
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
LTV.reg
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(AlgDesign)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
get.estimable.coefficients(full.design, frac.design)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
data2<- read_csv("Data2.csv")
data2<-data2%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee),  `BK`=factor(`BK`))
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
LTV.reg
data2<- read_csv("Data2.csv")
data2<-data2%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee),  `BK`=factor(`BK`))
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
LTV.reg
LTV.reg <-lm(LTV ~ APR + Fixed_Var+Fee + BK, data2)
LTV.reg <-lm(LTV ~ APR + Fix_Var+Fee + BK, data2)
LTV.reg <-lm(LTV ~ APR + Fix_Var+Annual_Fee + BK, data2)
LTV.reg
View(frac.design)
View(frac.design)
View(full.design)
View(full.design)
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,NA,0.01617592,NA,NA))
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,0.01617592,NA,NA))
full.design.results
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,0.01617592,NA,NA))
full.design.results
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Annual_Fee=c("0","20"),
Fix_Var=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
get.estimable.coefficients(full.design, frac.design)
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,0.01617592,NA,NA))
full.design.results
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC))
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(AlgDesign)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC))
View(data1_count)
View(data1_count)
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Annual_Fee=c("0","20"),
Fix_Var=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
get.estimable.coefficients(full.design, frac.design)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,0.01617592,NA,NA))
full.design.results
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC))
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Annual_Fee=c("0","20"),
Fix_Var=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
get.estimable.coefficients(full.design, frac.design)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC, data=data1_count, family=binomial)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*, data=data1_count, family=binomial)
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,0.01617592,NA,NA))
full.design.results
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
View(data1_count)
View(data1_count)
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Annual_Fee=c("0","20"),
Fix_Var=c("Fixed","Var"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
get.estimable.coefficients(full.design, frac.design)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*, data=data1_count, family=binomial)
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,0.01617592,NA,NA))
full.design.results
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
View(lr.data1)
View(lr.data1)
View(data1_count)
View(data1_count)
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Annual_Fee=c("0","20"),
Fix_Var=c("Fixed","Var."))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
get.estimable.coefficients(full.design, frac.design)
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*, data=data1_count, family=binomial)
full.design.results <- full.design %>%
mutate(sales=c(0.051546825,0.038672537, 0.021859992,0.023508866, 0.010550595, 0.004584047, NA,NA,NA,0.01617592,NA,NA))
full.design.results
full.design.results <- full.design.results %>%
mutate(pred = predict(lr.data1, newdata=full.design.results, type="response"),
pred_sales = 10000*pred)
full.design.results
data2<- read_csv("Data2.csv")
data2<-data2%>% mutate(Fix_Var=factor(Fix_Var),APR=factor(APR), Annual_Fee=factor(Annual_Fee),  `BK`=factor(`BK`))
LTV.reg <-lm(LTV ~ APR + Fix_Var+Annual_Fee + BK, data2)
LTV.reg
