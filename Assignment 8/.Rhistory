knitr::opts_chunk$set(echo=TRUE,      # Print all the code in all the chunks
warning=FALSE,  # Don't print warning statements
message=FALSE,  # Don't print other R output messages
comment=NA)     # Helps produce prettier output
library(gmodels)
library(modelr)
library(janitor)
library(haven)
library(readxl)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(mktg482)
# use load("filename.Rdata") for .Rdata files
load("smobile_churn.Rdata")
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("smobile_churn.Rdata")
smobile_training <- smobile %>% filter(training==1)
smobile_test<-smobile %>% filter(training==0)
smobile_training_lr<-glm(churn~revenue+mou+overage+roam+changem+changer+dropvce+blckvce+unansvce+custcare+threeway+months+uniqsubs+phones+eqpdays+age+children+creditaa+refurb+occprof+occcler+occcrft+occstud+occhmkr+occret+occself+travel+retcalls+refer+incmiss+income+mcycle,family=binomial, data=smobile_training)
summary(smobile_training_lr)
#Adding Odds Rations
cbind(COEF=coef(smobile_training_lr),confint(smobile_training_lr))
exp(cbind(COEF=coef(smobile_training_lr),confint(smobile_training_lr)))
pred_lr_training<-predict(smobile_training_lr, type="response")
pred_lr_test<-predict(smobile_training_lr,newdata=smobile_test ,type="response")
pred_lr_training <- predict(smobile_training_lr,type="response")
pred_lr_test <- predict(smobile_training_lr, newdata=smobile_test,type="response")
gainsplot(pred_lr_test,label.var =smobile_test$res)
