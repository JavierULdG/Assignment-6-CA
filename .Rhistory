library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint.default(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint.default(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit<-intuit%>% mutate(res=factor(res),state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.001, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint.default(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint.default(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit<-intuit%>% mutate(res=factor(res),state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.01, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
View(intuit)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 10,
decay=0.01, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit<-intuit%>% mutate(res=factor(res),state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 10,
decay=0.01, maxit=1000)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit<-intuit%>% mutate(res=factor(res),state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.01, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit<-intuit%>% mutate(res=factor(res),state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.01, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
load("intuit_online.Rdata")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.01, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
set.seed(13579)
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.01, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
View(pred_nn_test)
View(intuit)
View(intuit_test)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("intuit_online")
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("intuit_online.Rdata")
intuit_training <- intuit %>% filter(training==1)
intuit_test<-intuit %>% filter(training==0)
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, size=5, decay=0.01, maxit=1000)
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=5, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binominal, data=intuit_training)
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test type="response")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn_test,pred_nn_training, label.var =intuit_test$res )
gainsplot(pred_nn_test,pred_nn_training, label.var =intuit_test$res )
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("intuit_online.Rdata")
intuit_training <- intuit %>% filter(training==1)
intuit_test<-intuit %>% filter(training==0)
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=5, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_nn_training, label.var =intuit_test$res )
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint.default(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint.default(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit<-intuit%>% mutate(res=factor(res),state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.001, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
pred_nn_training<- predict(intuit_nn,type="raw")
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("intuit_online.Rdata")
intuit_training <- intuit %>% filter(training==1)
intuit_test<-intuit %>% filter(training==0)
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=5, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_nn_training, label.var =intuit_test$res )
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_training$res )
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn_training,pred_lr_training, label.var =intuit_training$res )
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=10, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn_training,pred_lr_training, label.var =intuit_training$res )
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=3, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn_training,pred_lr_training, label.var =intuit_training$res )
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=5, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn_training,pred_lr_training, label.var =intuit_training$res )
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=1, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn_training,pred_lr_training, label.var =intuit_training$res )
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("intuit_online.Rdata")
intuit_training <- intuit %>% filter(training==1)
intuit_test<-intuit %>% filter(training==0)
intuit_nn <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=5, decay=0.01, maxit=1000)
pred_nn_training<- predict(intuit_nn,type="raw")
pred_nn_test<- predict(intuit_nn,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn_training,pred_lr_training, label.var =intuit_training$res )
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("intuit_online.Rdata")
intuit_training <- intuit %>% filter(training==1)
intuit_test<-intuit %>% filter(training==0)
intuit_nn5 <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=5, decay=0.01, maxit=1000)
intuit_nn10 <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=10, decay=0.01, maxit=1000)
pred_nn5_training<- predict(intuit_nn5,type="raw")
pred_nn5_test<- predict(intuit_nn5,newdata = intuit_test,type="raw")
pred_nn10_training<- predict(intuit_nn10,type="raw")
pred_nn10_test<- predict(intuit_nn10,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn5_test,pred_nn10_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn5_training,pred_nn10_training,pred_lr_training, label.var =intuit_training$res )
pred_nn5_wave2<- intuit.wave2 %>%
mutate(pred_wave2=predict(intuit_nn5,newdata = intuit.wave2,type="raw"))
BER=7.2/180
BER
intuit.wave2<-pred_nn5_wave2 %>%
mutate(target=(pred_wave2>= BER))
View(intuit.wave2)
intuit.wave2<-pred_nn5_wave2 %>%
mutate(target=1*(pred_wave2>= BER))
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
rm(list=ls())
set.seed(13579)
load("intuit_online.Rdata")
intuit_training <- intuit %>% filter(training==1)
intuit_test<-intuit %>% filter(training==0)
intuit_nn5 <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=5, decay=0.01, maxit=1000)
intuit_nn10 <- nnet(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,data=intuit_training, size=10, decay=0.01, maxit=1000)
pred_nn5_training<- predict(intuit_nn5,type="raw")
pred_nn5_test<- predict(intuit_nn5,newdata = intuit_test,type="raw")
pred_nn10_training<- predict(intuit_nn10,type="raw")
pred_nn10_test<- predict(intuit_nn10,newdata = intuit_test,type="raw")
intuit_lr<-glm(res~speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue,family=binomial, data=intuit_training)
pred_lr_training<-predict(intuit_lr, type="response")
pred_lr_test<-predict(intuit_lr,newdata=intuit_test ,type="response")
gainsplot(pred_nn5_test,pred_nn10_test,pred_lr_test, label.var =intuit_test$res )
gainsplot(pred_nn5_training,pred_nn10_training,pred_lr_training, label.var =intuit_training$res )
pred_nn5_wave2<- intuit.wave2 %>%
mutate(pred_wave2=predict(intuit_nn5,newdata = intuit.wave2,type="raw"))
BER=7.2/180
BER
intuit.wave2<-pred_nn5_wave2 %>%
mutate(target=1*(pred_wave2>= BER))
intuit.wave2 %>%
group_by(target) %>%
summarise(num_target=n(), perc_target=num_target/25000, response_rate=mean(pred_wave2))
intuit_wave2_res<- intuit.wave2%>%
filter(target==1) %>%
summarise(frac_mailed=n()/25000,resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=25000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_wave2_res<- intuit.wave2%>%
filter(target==1) %>%
summarise(frac_mailed=n()/25000,resp_rate=mean(res==1)) %>%
mutate(num_mailed=25000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_wave2_res<- intuit.wave2%>%
filter(target==1) %>%
summarise(frac_mailed=n()/25000, resp_rate=mean(pred_wave2)) %>%
mutate(num_mailed=25000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_wave2_res
options(encoding = "utf-8")
intuit.wave2<-pred_nn5_wave2 %>%
mutate(target=1*(pred_wave2>= BER-0.02))
intuit.wave2 %>%
group_by(target) %>%
summarise(num_target=n(), perc_target=num_target/25000, response_rate=mean(pred_wave2))
intuit_wave2_res<- intuit.wave2%>%
filter(target==1) %>%
summarise(frac_mailed=n()/25000, resp_rate=mean(pred_wave2)) %>%
mutate(num_mailed=25000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_wave2_res
options(encoding = "utf-8")
intuit.wave2<-pred_nn5_wave2 %>%
mutate(target=1*(pred_wave2>= BER))
intuit.wave2 %>%
group_by(target) %>%
summarise(num_target=n(), perc_target=num_target/25000, response_rate=mean(pred_wave2))
intuit_wave2_res<- intuit.wave2%>%
filter(target==1) %>%
summarise(frac_mailed=n()/25000, resp_rate=mean(pred_wave2)) %>%
mutate(num_mailed=25000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_wave2_res
