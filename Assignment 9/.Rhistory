knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
rm(list=ls())
set.seed(13579)
data1<- read_csv("Data1.csv")
View(data1)
data1<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
View(data2)
data1<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), )
data1<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1<-uncount(data1_count, )
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1<-uncount(data1_count, ac)
View(data1_count)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1<-uncount(data1_count, `Accounts`)
View(data1)
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
data1<-uncount(data1_count, `Accounts`)
View(data1)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate( `Fix/Var.`=factor(`Fix/Var.`), Date=factor(Date),APR=factor(APR), `Annual Fee`=factor(`Annual Fee`), `VISA/MC`=factor(`VISA/MC`), `BK`=factor(`BK`))
View(data1_count)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate( Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
data1<-uncount(data1_count, `Accounts`)
accounts_lr<-glm(sale~ APR+ Date+Annual_Fee+Visa_MC+BK  ,   family=binomial, data=data1)
accounts_lr<-glm(sale~ APR+ Date+Annual_Fee+VISA_MC+BK  ,   family=binomial, data=data1)
View(accounts_lr)
accounts_lr<-glm( sale~ APR + Date + Annual_Fee + VISA_MC + BK, family=binomial, data=data1)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
data1<-uncount(data1_count, `Accounts`)
str(data1)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`), sales=factor(sales))
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`), sale=factor(sale))
data1<-uncount(data1_count, `Accounts`)
str(data1)
accounts_lr<-glm( sale~ APR + Date + Annual_Fee + VISA_MC + BK, family=binomial, data=data1)
accounts_lr<-glm(sale~ APR + Date + Annual_Fee + VISA_MC + BK, family=binomial, data=data1, maxit=100)
accounts_lr<-glm(sale~ APR + Date + Annual_Fee + VISA_MC + BK, family=binomial, data=data1, maxit=1000)
asdasd
install.packages("AlgDesign")
knitr::opts_chunk$set(echo = TRUE)
options(encoding = "utf-8")
library(tidyverse)
library(mktg482)
library(nnet)
library(knitr)
library(janitor)
library(readxl)
library(psych)
library(statar)
library(mktg482)
library(tidyverse)
library(sjPlot)
library(AlgDesign)
rm(list=ls())
set.seed(13579)
data1_count<- read_csv("Data1.csv")
data2<- read_csv("Data2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`), sale=factor(sale))
data1<-uncount(data1_count, `Accounts`)
str(data1)
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(sale~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(sale~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`), sale=factor(sale))
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(sale~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
View(data1)
View(data1)
View(data1_count)
data1_count<- read_csv("Data1v2.csv")
data1_count<-data1_count%>% mutate(Fix_Var=factor(Fix_Var), Date=factor(Date),APR=factor(APR), Annual_Fee=factor(Annual_Fee), VISA_MC=factor(VISA_MC), `BK`=factor(`BK`))
##Generate Fractional Design
exp.design <- list(APR=c("14.9","16.8","19.8"),
Fee=c("0","20"),
Rate=c("Fixed","Variable"))
full.design <- expand.grid(exp.design)
full.design
frac.design <-optFederov(data=full.design, nTrials=5)
frac.design$design
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*VISA_MC*BK, data=data1_count, family=binomial)
summary(lr.data1)
#We cannot choose Visa/Master Card so I ignored VISA_MC
lr.data1 <-glm(cbind(Sales,Fails)~APR*Fix_Var*Annual_Fee*BK, data=data1_count, family=binomial)
summary(lr.data1)
