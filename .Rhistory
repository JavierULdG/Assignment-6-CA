knitr::opts_chunk$set(echo = TRUE)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=sum(target_log), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
knitr::opts_chunk$set(echo = TRUE)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint(intuit_logit1))
View(trainSplit)
exp(cbind(OR=coef(intuit_logit1), confint(intuit_logit1)))
View(intuit_logit1)
View(intuit_logit1)
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
nn_intuit <- nnet(buyer ~ gender + last + total + child + youth + do_it +
reference + art + geog, data=intuit, size= 5,
decay=0.1, maxit=1000)
View(trainSplit)
View(intuit)
load("C:/Users/javie/Desktop/Git Folder/Assignment 6/Assignment-6-CA/intuit_online.RData")
knitr::opts_chunk$set(echo = TRUE)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
nn_intuit <- nnet(buyer ~ gender + last + total + child + youth + do_it +
reference + art + geog, data=intuit, size= 5,
decay=0.1, maxit=1000)
intuit_train<-intuit%>% filter(training==1)
intuit_train<-intuit%>% filter(training==1)
Intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.1, maxit=1000)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
knitr::opts_chunk$set(echo = TRUE)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
install.packages("nnet")
# install.packages("sjPlot")
install.packages("nnet")
# install.packages("nnet")
install.packages("sjPlot")
knitr::opts_chunk$set(echo = TRUE)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.1, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="response")
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=Intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit.training$res)
knitr::opts_chunk$set(echo = TRUE)
#library(knitr)
#library(psych)
#library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit_train<-intuit%>% filter(training==1)
Intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.1, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=Intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit.training$res)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit.training$res)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
library(mktg482)
install.packages(library(mktg482))
install.packages(mktg482)
devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
devtools::install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
library(mktg482)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(dplyr)
library(nnet)
library(sjPlot)
library(devtools)
install.packages(devtools)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(dplyr)
library(dplyr)
install.packages("devtools")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
install.packages("dplyr")
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
install.packages(c("dbplyr", "fs", "janitor", "sys"))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
install.packages("devtools")
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
install.packages('TMB', type = 'source')
install.packages("TMB", type = "source")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
install.packages("devtools")
library(devtools)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
remove.package("devtools")
install.package('devtools', dependencies = TRUE)
remove.packages("devtools")
install.packages('devtools', dependencies = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
install_github("fzettelmeyer/mktg482", upgrade = "never", force = TRUE)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit.training$res)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit.training$res)
library(mktg482)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit.training$res)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit_train<-intuit%>% filter(training==1)
Intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.1, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=Intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit.training$res)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
View(pred_nn_test)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
View(pred_nn_test)
cbind(COEF=coef.default(intuit_logit1), confint(intuit_logit1))
cbind(COEF=coef(intuit_logit1), confint.default(intuit_logit1))
cbind(COEF=coef(intuit_logit1), confint.default(intuit_logit1))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(knitr)
library(psych)
library(statar)
library(tidyverse)
library(janitor)
library(nnet)
library(sjPlot)
library(devtools)
library(mktg482)
rm(list=ls())
load("intuit_online.Rdata")
BER=7.2/180
BER
intuit_logit1 <- glm(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, family = binomial(logit),data=intuit)
summary(intuit_logit1)
cbind(COEF=coef(intuit_logit1), confint.default(intuit_logit1))
exp(cbind(OR=coef(intuit_logit1), confint.default(intuit_logit1)))
intuit <- intuit %>%
mutate(pred_prob_log = predict(intuit_logit1, type = "response"))
#assign a decile to intuit dataset
intuit <- intuit %>%
mutate(pred_prob_dec = ntile(-pred_prob_log, 10))
intuit %>%
group_by(pred_prob_dec) %>%
summarize(response_rate = mean(res.numeric))%>%
ggplot() + geom_col(aes(x=pred_prob_dec,y=response_rate))+ scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10))
intuit <- intuit %>%
mutate(target_log=1*(pred_prob_log>= BER))
intuit %>%
group_by(target_log) %>%
summarise(num_target=n(), perc_target=num_target/50000, response_rate=mean(pred_prob_log))
intuit_log_res<- intuit%>%
filter(target_log==1) %>%
summarise(frac_mailed=n()/nrow(intuit),resp_rate=mean(res.numeric==1)) %>%
mutate(num_mailed=50000*frac_mailed,
num_responded=resp_rate*num_mailed,
profit=180*num_responded-1.6*num_mailed,
ave_profit=profit/num_mailed)
intuit_log_res
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.1, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
View(intuit_test)
View(intuit_train)
gainsplot(pred_nn_training, pred_nn_test)
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 1,
decay=0.01, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.001, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
View(pred_nn_training)
View(intuit)
intuit<-intuit%>% mutate(state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.001, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
View(intuit)
intuit<-intuit%>% mutate(res=factor(res),state=factor(state), version2013=factor(version2013),upgraded=factor(upgraded), payroll=factor(payroll), bizflag=factor(bizflag),sex=factor(sex))
intuit_train<-intuit%>% filter(training==1)
intuit_test<-intuit%>% filter(training==0)
nn_intuit <- nnet(res ~ speeddown+speedup+last+numords+dollars+sincepurch+version2013+upgraded+payroll+bizflag+sex+income+medhvalue, data=intuit_train, size= 5,
decay=0.001, maxit=1000)
pred_nn_training <- predict(nn_intuit, type="raw")
pred_nn_test <- predict(nn_intuit, newdata=intuit_test, type="raw")
gainsplot(pred_nn_training, pred_nn_test,label.var=intuit_train$res)
